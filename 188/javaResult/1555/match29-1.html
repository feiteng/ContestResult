<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>655_volodymyr_k.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>655_volodymyr_k.java</CENTER></H3><HR>
<PRE>
class Solution {
    private static long MOD = 1_000_000_007;
    
    public int ways(String[] pizza, int k) {
        int rows = pizza.length, cols = pizza[0].length();
        
        int[][] sum = new int[rows + 1][cols + 1];
        for (int i = 0; i &lt; rows; i++) {
            int temp = 0;
            for (int j = 0; j &lt; cols; j++) {
                temp += pizza[i].charAt(j) == 'A' ? 1 : 0;
                sum[i + 1][j + 1] = sum[i][j + 1] + temp;
            }
        }
<A NAME="0"></A>        
        long[][][][][] memo = new long[k][rows][cols][rows][cols];
        
        <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#0',2,'match29-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>return (int) find(0, 0, rows - 1, cols - 1, sum, memo, k - 1);
    }
    
    private long find(int r1, int c1, int r2, int c2, int[][] sum, long[][][][][] memo</B></FONT>, int left) {
        if (left == 0) return 1;
        
        if (memo[left][r1][c1][r2][c2] != 0) {
            return memo[left][r1][c1][r2][c2] - 1;
<A NAME="1"></A>        }
        
        long res = 0;
        <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#1',2,'match29-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>boolean found = false;
        
        for (int r = r1; r &lt; r2; r++) {
            if (calcAppl(sum, r1, c1, r, c2) != 0 &amp;&amp; calcAppl(sum, r + 1, c1, r2, c2) != 0) {
                //System.out.println((r + 1) + &quot;,&quot; + c1 + &quot; - &quot; + r2 + &quot;,&quot; + c2);
<A NAME="2"></A>                res += /*find(r1, c1, r, c2, sum, memo)*/find</B></FONT>(r + 1, c1, r2, c2, sum, memo, left - 1);
                res %= MOD;
                found = true;
            <FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#2',2,'match29-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
        }
        
        for (int c = c1; c &lt; c2; c++) {
            if (calcAppl(sum, r1, c1, r2, c) != 0 &amp;&amp; calcAppl(sum, r1, c + 1, r2, c2) != 0) {
                //System.out.println(r1 + &quot;,&quot; + (c + 1) + &quot; | &quot; + r2 + &quot;,&quot; + c2);
<A NAME="3"></A>                res += /*find(r1, c1, r2, c, sum, memo)*/find</B></FONT>(r1, c + 1, r2, c2, sum, memo, left - 1);
                res %= MOD;
                found = true;
            <FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match29-0.html#3',2,'match29-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
        }
        
        memo[left][r1][c1][r2][c2] = res + 1;
        return res;
    }
    
    private int calcAppl(int[][] sum, int r1, int c1, int r2, int c2) {
        return sum[r2 + 1][c2 + 1] - sum[r2 + 1][c1] - sum[r1][c2 + 1] + sum[r1][c1];
    }
}</B></FONT>
</PRE>

</BODY>
</HTML>
