<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>9_jonathanirvings.cpp</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>9_jonathanirvings.cpp</CENTER></H3><HR>
<PRE>
//start of jonathanirvings' template v3.0.3 (BETA)

#include &lt;bits/stdc++.h&gt;
using namespace std;

typedef long long LL;
typedef pair&lt;int,int&gt; pii;
typedef pair&lt;LL,LL&gt; pll;
typedef pair&lt;string,string&gt; pss;
typedef vector&lt;int&gt; vi;
typedef vector&lt;vi&gt; vvi;
typedef vector&lt;pii&gt; vii;
typedef vector&lt;LL&gt; vl;
typedef vector&lt;vl&gt; vvl;

double EPS = 1e-9;
int INF = 1000000005;
long long INFF = 1000000000000000005LL;
double PI = acos(-1);
int dirx[8] = {-1,0,0,1,-1,-1,1,1};
int diry[8] = {0,1,-1,0,-1,1,-1,1};

#ifdef TESTING
  #define DEBUG fprintf(stderr,&quot;====TESTING====\n&quot;)
  #define VALUE(x) cerr &lt;&lt; &quot;The value of &quot; &lt;&lt; #x &lt;&lt; &quot; is &quot; &lt;&lt; x &lt;&lt; endl
  #define debug(...) fprintf(stderr, __VA_ARGS__)
#else
  #define DEBUG 
  #define VALUE(x)
  #define debug(...)
#endif

#define FOR(a,b,c) for (int (a)=(b);(a)&lt;(c);++(a))
#define FORN(a,b,c) for (int (a)=(b);(a)&lt;=(c);++(a))
#define FORD(a,b,c) for (int (a)=(b);(a)&gt;=(c);--(a))
#define FORSQ(a,b,c) for (int (a)=(b);(a)*(a)&lt;=(c);++(a))
#define FORC(a,b,c) for (char (a)=(b);(a)&lt;=(c);++(a))
#define FOREACH(a,b) for (auto &amp;(a) : (b))
#define REP(i,n) FOR(i,0,n)
#define REPN(i,n) FORN(i,1,n)
#define MAX(a,b) a = max(a,b)
#define MIN(a,b) a = min(a,b)
#define SQR(x) ((LL)(x) * (x))
#define RESET(a,b) memset(a,b,sizeof(a))
#define fi first
#define se second
#define mp make_pair
#define pb push_back
#define ALL(v) v.begin(),v.end()
#define ALLA(arr,sz) arr,arr+sz
#define SIZE(v) (int)v.size()
#define SORT(v) sort(ALL(v))
#define REVERSE(v) reverse(ALL(v))
#define SORTA(arr,sz) sort(ALLA(arr,sz))
#define REVERSEA(arr,sz) reverse(ALLA(arr,sz))
#define PERMUTE next_permutation
#define TC(t) while(t--)

inline string IntToString(LL a){
  char x[100];
  sprintf(x,&quot;%lld&quot;,a); string s = x;
  return s;
}

inline LL StringToInt(string a){
  char x[100]; LL res;
  strcpy(x,a.c_str()); sscanf(x,&quot;%lld&quot;,&amp;res);
  return res;
}

inline string GetString(void){
  char x[1000005];
  scanf(&quot;%s&quot;,x); string s = x;
  return s;
}

inline string uppercase(string s){
  int n = SIZE(s); 
  REP(i,n) if (s[i] &gt;= 'a' &amp;&amp; s[i] &lt;= 'z') s[i] = s[i] - 'a' + 'A';
  return s;
}

inline string lowercase(string s){
  int n = SIZE(s); 
  REP(i,n) if (s[i] &gt;= 'A' &amp;&amp; s[i] &lt;= 'Z') s[i] = s[i] - 'A' + 'a';
  return s;
}

inline void OPEN (string s) {
  #ifndef TESTING
  freopen ((s + &quot;.in&quot;).c_str (), &quot;r&quot;, stdin);
  freopen ((s + &quot;.out&quot;).c_str (), &quot;w&quot;, stdout);
  #endif
}

#ifdef TESTING
int main() {}
#endif
<A NAME="0"></A>
//end of jonathanirvings' template v3.0.3 (BETA)

<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match33-1.html#0',3,'match33-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>class Solution {
public:
  int findLatestStep(vector&lt;int&gt;&amp; arr, int m) {
    int n = SIZE(arr);
    vi lenr(n+2,0);
    vi lenl(n+2,0);
    vi ixr(n+2,0);
    vi ixl(n+2,0);
    string s(n+2,'0');

    multiset&lt;int&gt; ada;
    int risan = -1;</B></FONT>
    REP(i,SIZE(arr))
    {
      int x = arr[i];
      if (s[x-1] == '1')
      {
        ada.erase(ada.find(lenl[x-1])); 
      }
      if (s[x+1] == '1')
      {
        ada.erase(ada.find(lenr[x+1])); 
      }

      int len = 1;
      int l,r;
      if (s[x-1] == '1' &amp;&amp; s[x+1] == '1')
      {
        len = lenl[x-1] + lenr[x+1] + 1;
        l = ixl[x-1];
        r = ixr[x+1];
      } else if (s[x-1] == '1')
      {
        len = lenl[x-1] + 1;
        l = ixl[x-1];
        r = x;
      } else if (s[x+1] == '1')
      {
        len = lenr[x+1] + 1;
        l = x;
        r = ixr[x+1];
<A NAME="1"></A>      } else
      {
        len = 1;
<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match33-1.html#1',3,'match33-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>        l = r = x;
      }
      lenr[l] = len;
      lenl[r] = len;
      ixr[l] = r;
      ixl[r] = l;
      ada.insert(len);
      s[x] = '1';

      if (ada.count(m)) risan = i + 1;
    }
    return risan;
  }
};</B></FONT>
</PRE>
</BODY>
</HTML>
