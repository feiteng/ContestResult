<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>348__merlin_.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>348__merlin_.java</CENTER></H3><HR>
<PRE>
class Solution {
    public boolean[] distanceLimitedPathsExist(int n, int[][] ed, int[][] qry) {
        int m=ed.length,q=qry.length,i;
        Edge e[]=new Edge[m];
        for(i=0;i&lt;m;i++)
        e[i]=new Edge(ed[i][0],ed[i][1],ed[i][2],i);
<A NAME="3"></A>        
        Query qr[]=new Query[q];
        for(i=0;i&lt;q;i++)
        qr[i]=new Query(qry[i][0],qry[i][1],qry[i][2],i)<FONT color="#6cc417"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#3',2,'match2-top.html#3',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>;

        Arrays.sort(e, new Comparator&lt;Edge&gt;() {
            @Override
            public int compare(Edge o1, Edge o2) {</B></FONT>
<A NAME="4"></A>                if(o1.wt&gt;o2.wt) return 1;
                else if(o1.wt==o2.wt) return o1.id&gt;o2.id?1:-1;
                else return -1;
            <FONT color="#151b8d"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#4',2,'match2-top.html#4',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}});
        Arrays.sort(qr, new Comparator&lt;Query&gt;() {
            @Override
            public int compare(Query o1, Query o2) {</B></FONT>
                if(o1.wt&gt;o2.wt) return 1;
                else if(o1.wt==o2.wt) return o1.id&gt;o2.id?1:-1;
                else return -1;
            }});
        
        boolean ans[]=new boolean[q];
        int j=0;
        DSU ds=new DSU(n);
        for(i=0;i&lt;q;i++)
<A NAME="5"></A>        {
            while(j&lt;m &amp;&amp; e[j].wt&lt;qr[i].wt)
            {
                <FONT color="#c8c2a7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#5',2,'match2-top.html#5',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>ds.unite(e[j].x,e[j].y);
                j++;
            }
            ans[qr[i].id]=(ds.getPar(qr[i].x)==ds.getPar(qr[i].y));
        }
<A NAME="0"></A>        return ans;
    }</B></FONT>
    
    <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#0',2,'match2-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>class DSU
    {
        int connected,par[],sz[];

        DSU(int n)
        {
            par=new int[n];
            sz=new</B></FONT> int[n];
            for(int i=0;i&lt;n;i++)
            {
                par[i]=i;
                sz[i]=1;
            }
            connected=n;
        }

        int getPar(int u)
        {
            while(u!=par[u])
            {
                par[u]=par[par[u]];
                u=par[u];
            }
            return u;
        }

<A NAME="1"></A>        int getSize(int u)
        {
            return sz[getPar(u)];
        <FONT color="#f63526"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#1',2,'match2-top.html#1',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}

        void unite(int u, int v)
        {
            int par1=getPar(u),par2=getPar(v);

            if(par1==par2) return;
            connected--;
            if(sz[par1]&gt;sz[par2])
            p</B></FONT>ar1=par1^par2^(par2=par1);

<A NAME="2"></A>            sz[par2]+=sz[par1];
            sz[par1]=0;
            par[par1]=par[par2];
        <FONT color="#77bfc7"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match2-0.html#2',2,'match2-top.html#2',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}
    }

    class Edge
    {
        int x,y,id,wt;
        Edge(int a,int b,int c,int d)
        {
            x=a;
            y=b;
            wt=c;
            id=d;
        }
    }</B></FONT>

    class Query
    {
        int x,y,wt,id;
        Query(int a,int b,int c,int d)
        {
            x=a;
            y=b;
            wt=c;
            id=d;
        }
    }

}
</PRE>

</BODY>
</HTML>
