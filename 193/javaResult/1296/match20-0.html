<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>600_i30361.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>600_i30361.java</CENTER></H3><HR>
<PRE>
<A NAME="0"></A>	
	class TreeAncestor {

		int[][] st = n<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match20-1.html#0',3,'match20-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>ull;
		int n = 0;
<A NAME="1"></A>		int h = 0;
	    public TreeAncestor(int n, int[] parent) {
	    	this.n = n;
	    	this.h = (i</B></FONT>nt)Math.floor(Math.log10<FONT color="#f63526"><A HREF="javascript:ZweiFrames('match20-1.html#1',3,'match20-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>(n*2) / Math.log10(2)) ;
	    	this.st = new int[h][n];
	    	// base case
	    	for(int j=0; j&lt;n; j++) {
	    		st[0][j] = parent[j];
<A NAME="2"></A>	    	}
	    	for(int i=1; (1&lt;&lt;i)&lt;=n; i++) {
	    		for(int j=0; j&lt;n; j++) {</B></FONT>
	    			st[i][j] = st[i-1][j] ==<FONT color="#77bfc7"><A HREF="javascript:ZweiFrames('match20-1.html#2',3,'match20-top.html#2',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B> -1 ? -1 : st[i-1][st[i-1][j]];
	    		}
	    	}
	    }
	    
	    public int getKthAncestor(int node, int k) {</B></FONT>
	    	int pow = h-1;
	    	while( pow &gt;= 0) {
	    		if( k &gt;= (1 &lt;&lt; pow) ) {
	    			node = st[pow][node];
	    			k -= (1 &lt;&lt; pow);
	    			if( node == -1 ) {
	    				return -1;
	    			}
	    		}
	    		pow--;
	    	}
	    	return node;
	    }
	}


/**
 * Your TreeAncestor object will be instantiated and called as such:
 * TreeAncestor obj = new TreeAncestor(n, parent);
 * int param_1 = obj.getKthAncestor(node,k);
 */
</PRE>

</BODY>
</HTML>
