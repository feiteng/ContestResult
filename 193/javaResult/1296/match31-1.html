<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>461_iejepwy.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff" style="margin-left:25">
<HR>
<H3><CENTER>461_iejepwy.java</CENTER></H3><HR>
<PRE>
class TreeAncestor {
    int n;

//    int[][] dp;
    int[] d;
    int[] parent;

    int getd(int[] parent,int cur){
        if(cur==0){
            return 0;
        }
        if(d[cur]!=-1){
            return d[cur];
        }
        d[cur]=getd(parent,parent[cur])+1;
        return d[cur];
    }
    public TreeAncestor(int n, int[] parent) {
        this.n=n;
        this.parent=parent;
        int maxd=0;
        d=new int[n];
        Arrays.fill(d,-1);
        d[0]=0;
        for(int i=0;i&lt;n;i++){
            maxd=Math.max(maxd,getd(parent,i));
        }
//        dp=new int[n][maxd+1];


//
//        for(int[] i:dp){
//            Arrays.fill(i,-1);
//        }
//        for(int i=0;i&lt;n;i++){
<A NAME="0"></A>//            dp[i][1]=parent[i];
//            dp[i][0]=i;
//        }
    <FONT color="#0000ff"><div style="position:absolute;left:0"><A HREF="javascript:ZweiFrames('match31-0.html#0',2,'match31-top.html#0',1)"><IMG SRC="back.gif" ALT="other" BORDER="0" ALIGN="left"></A></div><B>}

    public int getKthAncestor(int node, int k) {
        if(k&gt;d[node]){
            return -1;
        }
//        if(dp[node][k]!=-1){
//            return dp[node][k];
//        }
//        dp[node][k]=getKthAncestor(dp[node][1],k-1);
//        return dp[node][k];
        while(k!=0){
            node=parent[node];
            k--;
        }
        return node;
    }
}</B></FONT>
</PRE>

</BODY>
</HTML>
