<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>79_gribs.py</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>79_gribs.py</CENTER></H3><HR>
<PRE>
class Solution:
<A NAME="0"></A>    def matrixRankTransform(self, matrix: List[List[int]]) -&gt; List[List[int]]:
        N = len(matrix)
        M = len(matrix[0])
        out <FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match24-1.html#0',3,'match24-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>= [[0]*M for _ in range(N)]
        sm = []
        for i in range(N): 
            for j in range(M): 
                sm.append((matrix[i][j], i, j))
        sm.sort(reverse =</B></FONT> True)
        rowrank = [0]*N
        colrank = [0]*M
        while sm: 
            el = sm.pop()
            neighbr = defaultdict(list)
            neighbc = defaultdict(list)
            
            v, i, j = el
            neighbr[i].append(j)
            neighbc[j].append(i)
            
            same = set([(i, j)])
            while sm and sm[-1][0] == v: 
                _, i, j = sm.pop()
                same.add((i,j))
                neighbr[i].append(j)
                neighbc[j].append(i)
            # print(same, neighbr, neighbc)
            while same: 
                i, j = same.pop()
                clique = set([(i, j)])
                cliquer = set([i])
                cliquec = set([j])
                stack = [(i,j)]
                while stack: 
                    ij = stack.pop()
                    i, j = ij
                    
                    clique.add(ij)
                    cliquer.add(i)
                    cliquec.add(j)
                    for ni in neighbr[i]: 
                        if (i, ni) in same: 
                            stack.append((i, ni))
                            same.remove((i, ni))
                    for nj in neighbc[j]: 
                        if (nj, j) in same: 
                            stack.append((nj, j))
                            same.remove((nj, j))
                # print(same)
                minrank = 0
                for i in cliquer: 
                    if rowrank[i] &gt; minrank: 
                        minrank = rowrank[i]
<A NAME="1"></A>                for j in cliquec: 
                    if colrank[j] &gt; minrank: 
                        minrank = colrank[j]
                <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match24-1.html#1',3,'match24-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>for i in cliquer: 
                    rowrank[i] = minrank + 1
                for j in cliquec: 
                    colrank[j] = minrank + 1
                    
                for i, j in clique: 
                    out[i][j] =</B></FONT> minrank + 1
                    
        return out
</PRE>

</BODY>
</HTML>
