<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
 <TITLE>651_yrclamb.java</TITLE>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <script type="text/javascript">
  <!--
   function ZweiFrames(URL1,F1,URL2,F2)
   {
    parent.frames[F1].location.href=URL1;
    parent.frames[F2].location.href=URL2;
   }
  //-->
  </script>
</HEAD>
<BODY BGCOLOR="#ffffff">
<HR>
<H3><CENTER>651_yrclamb.java</CENTER></H3><HR>
<PRE>
class Solution {
    public int maxProfit(int[] inventory, int orders) {
<A NAME="0"></A>        int s = 0;
        int e = 0;
        for(int inv : inventory)
            e = Math.max(e, inv)<FONT color="#0000ff"><A HREF="javascript:ZweiFrames('match16-1.html#0',3,'match16-top.html#0',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>;
        
        
        while( s &lt;= e ){
            //System.out.println(s + &quot;~&quot; + e);
            int m = ( s + e ) / 2;
            long ttl = 0;
            for(int inv : inventory){
                if(m &lt; inv){
                    ttl += (long)(inv - m);
                }
            }
            
            if(ttl &gt; (long)orders){
                s = m + 1;
            }
            else if(t</B></FONT>tl &lt; (long)orders){
                e = m - 1;
            }
<A NAME="1"></A>            else{
                s = m+1;
                e = m;
            <FONT color="#f63526"><A HREF="javascript:ZweiFrames('match16-1.html#1',3,'match16-top.html#1',1)"><IMG SRC="forward.gif" ALT="other" BORDER="0" ALIGN="right"></A><B>}
        }
        //System.out.println(&quot;e=&quot; + e);
        long ans = 0;
        long curttl = 0;
        for(int inv : inventory){
            if</B></FONT>(e &gt;= inv) continue;
            // e+1 ~ inv
            ans += ((long)inv + (long)e + 1L) * (long)(inv - e) / 2L;
            //System.out.println(ans + &quot;, curttl = &quot; + curttl);
            ans %= 1000000007L;
            curttl += (long)(inv - e);
        }
        
        if(curttl &gt; (long)orders){
            ans -= (long)(curttl - orders) * (long)(e+1);
            //System.out.println(&quot;left &quot; + (curttl - orders));
        }
        //System.out.println(&quot;???&quot; + ans % 1000000007L);
        while(ans &lt; 0){
            ans += 1000000007L;
        }
        
        return (int)ans;
    }
}
</PRE>

</BODY>
</HTML>
